actions: CONFIGURE_DATAWORKER
spec:
    name: DVD Rental customer Sumamry 11
    domain: ""
    specDigest: null
    etlWorker:
        name: "DVD rental Details"
        extracter:
            - name: "dvd-rental-summary-extract"
              dataSource: "ds-173ddadc-0efc-4819-a130-d7673a0d1124"
              label: "dvd-rental-summary-extract"
              inputFromLabel: ""
              dataRule:
                dataBase: "dvdrental"
                rawQuery:
                    dataTables: ["dvdrental"]
                    rawQuery: "SELECT 
                            c.customer_id,
                            c.first_name AS customer_first_name,
                            c.last_name AS customer_last_name,
                            c.email AS customer_email,
                            c.activebool AS is_active,
                            a.address AS customer_address,
                            a.district,
                            ci.city AS customer_city,
                            co.country AS customer_country,
                            f.title AS film_title,
                            cat.name AS category_name,
                            act.first_name || ' ' || act.last_name AS actor_name,
                            r.rental_date,
                            r.return_date,
                            s.first_name || ' ' || s.last_name AS staff_name,
                            p.payment_date,
                            p.amount AS payment_amount
                          FROM 
                              rental r
                          JOIN customer c ON r.customer_id = c.customer_id
                          JOIN address a ON c.address_id = a.address_id
                          JOIN city ci ON a.city_id = ci.city_id
                          JOIN country co ON ci.country_id = co.country_id
                          JOIN inventory i ON r.inventory_id = i.inventory_id
                          JOIN film f ON i.film_id = f.film_id
                          JOIN film_category fc ON f.film_id = fc.film_id
                          JOIN category cat ON fc.category_id = cat.category_id
                          JOIN film_actor fa ON f.film_id = fa.film_id
                          JOIN actor act ON fa.actor_id = act.actor_id
                          JOIN staff s ON r.staff_id = s.staff_id
                          JOIN payment p ON r.rental_id = p.rental_id
                          ORDER BY 
                              r.rental_date DESC;"
                    textQuery: ""
                    batchSize: 0
        loader:
            - name: dvd-rental-summary-loader
              dataSource: "ds-7ff59689-33d7-474d-9346-e0fe67fa5d8a"
              domain: ""
              labels: ["dvd-rental-summary-extract"]
              dataRule:
                dataBase: dvdrentalwarehouse
                dataTables: {"dvd-rental-summary-extract":"customer_rental_summary_new"}
                createTables: true
                schemaQueries: ["CREATE TABLE customer_rental_summary_new (
                        customer_id INT NOT NULL,
                        customer_first_name VARCHAR(50) NOT NULL,
                        customer_last_name VARCHAR(50) NOT NULL,
                        customer_email VARCHAR(100),
                        is_active BOOLEAN NOT NULL DEFAULT TRUE,
                        customer_address VARCHAR(255) NOT NULL,
                        district VARCHAR(100),
                        customer_city VARCHAR(100) NOT NULL,
                        customer_country VARCHAR(100) NOT NULL,
                        film_title VARCHAR(255) NOT NULL,
                        category_name VARCHAR(100) NOT NULL,
                        actor_name VARCHAR(100) NOT NULL,
                        rental_date TIMESTAMP NOT NULL,
                        return_date TIMESTAMP NULL,
                        staff_name VARCHAR(100) NOT NULL,
                        payment_date TIMESTAMP NOT NULL,
                        payment_amount DECIMAL(10, 2) NOT NULL
                    );"]
                generateSchemaByPlatform: false
                batchSize: 60
                batchWait: 1
        transformers:
            steps:
                - column:
                    add:
                        - name: ""
                          value: ""
                          position: ""
                          condition: ""
                          entities: ""
                          dataTable: ""
                          label: ""
                          conditionOperator: ""
                          conditionVal: ""
                    rename:
                        - name: ""
                          value: ""
                          position: ""
                          condition: ""
                          entities: ""
                          dataTable: ""
                          label: ""
                          conditionOperator: ""
                          conditionVal: ""
                    drop:
                        - name: ""
                          value: ""
                          position: ""
                          condition: ""
                          entities: ""
                          dataTable: ""
                          label: ""
                          conditionOperator: ""
                          conditionVal: ""
                    update:
                        - name: ""
                          value: ""
                          position: ""
                          condition: ""
                          entities: ""
                          dataTable: ""
                          label: ""
                          conditionOperator: ""
                          conditionVal: ""
                    groupBy: []
                  row:
                    drop:
                        - name: ""
                          value: ""
                          entity: []
                          condition: ""
                          conditionOperator: ""
                          conditionVal: ""
                          dataTable: ""
                          label: ""
                    update:
                        - name: ""
                          value: ""
                          entity: []
                          condition: ""
                          conditionOperator: ""
                          conditionVal: ""
                          dataTable: ""
                          label: ""
                  stepId: ""
            types:
                classified: []
                vars: []
                useDeclared: false
            scripts: []
            embeddingTransformers: []
        label: "vapusdata dvdrental ETL 1"
    dataWorkerId: ""
    createdBy: ""
    status: ""
    metadata:
        scheduleTab:
          syncTab: 
              - frequency:  MINUTES
                value: 10
          limit: 100
    associatedDataProducts: []
    dataWorkerType: ETL
